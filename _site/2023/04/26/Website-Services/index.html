<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>HTTPS 配置教程 (A Tutorial for HTTPS)</title>
    <meta name="description" content="HTTP 是一种用于分布式、协作式和超媒体信息系统的应用层协议, 它是一种发布和接收 HTML 页面的方法, 被用于在Web浏览器和网站服务器之间传递信息. HTTP 默认工作在 TCP 协议 80 端口, 但它以明文方式发送内容, 不提供任何方式的数据加密, 因此不适合传输敏感信息.为了解决 HTTP 不安全的...">

    <!-- 网站所有权验证 -->
    <meta name="baidu-site-verification" content="code-kzX4R1yDEi" />
    <meta name="google-site-verification" content="kj0sMKl0iZFsV2KPqmN9OJ3S7aeCrJnNYAOTpJzXCz4" />
    <meta name="msvalidate.01" content="C9A829578EE81A43ECA102B601A5E052" />

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_8v3czwksspqlg14i.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/zui/1.9.2/css/zui.min.css">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/2023/04/26/Website-Services/">
    <link rel="alternate" type="application/rss+xml" title="Jarvis' Blog (总有美丽的风景让人流连)" href="http://localhost:4000/feed.xml ">


    <script>
    // 百度统计代码
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?b9d127980a49e998bbedb8aab536a81d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>


    <script>
    // google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-108096001-2', 'auto');
      ga('send', 'pageview');

    </script>





<!--  -->
    
<script type="text/javascript">
    var host = "jarvis73.com";
    if ((host == window.location.host) && (window.location.protocol != "https:"))
      window.location.protocol = "https";
</script>
</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/index.html" class="brand">Jarvis' Blog (总有美丽的风景让人流连)</a>
        <small>总有美丽的风景让人流连</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                <li>
                    
                    <a href="/index.html">
                    
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>

                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/wiki/">
                        
                            <i class="fa fa-book"></i>Wiki
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/collection/">
                        
                            <i class="fa fa-bookmark"></i>Collections
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-heart"></i>About
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" post>
    <div class="left-jekyll">
        <h1>HTTPS 配置教程 (A Tutorial for HTTPS)</h1>
        <div class="label-custom">

            <div class="label-custom-card">
                <i class="fa fa-calendar"></i>2023-04-26
            </div>

            

            <div class="label-custom-card">
                <i class="fa fa-user"></i>Jarvis
                
            </div>

            <div class="label-custom-card">
                <i class="fa fa-key"></i>Post  
            </div>

            <div class="label-custom-card">
            


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#Config" title="Category: Config" rel="category">Config</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


            </div>

        </div>
        <hr>
        <article itemscope itemtype="http://schema.org/BlogPosting">
        <ul id="markdown-toc">
  <li><a href="#http-和-https" id="markdown-toc-http-和-https">HTTP 和 HTTPS</a></li>
  <li><a href="#配置-nginx" id="markdown-toc-配置-nginx">配置 Nginx</a></li>
  <li><a href="#域名解析" id="markdown-toc-域名解析">域名解析</a></li>
  <li><a href="#申请免费-ssl-证书" id="markdown-toc-申请免费-ssl-证书">申请免费 SSL 证书</a></li>
  <li><a href="#在-nginx-中配置反向代理以及证书" id="markdown-toc-在-nginx-中配置反向代理以及证书">在 Nginx 中配置反向代理以及证书</a></li>
</ul>

<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP">HTTP</a> 是一种用于分布式、协作式和超媒体信息系统的应用层协议, 它是一种发布和接收 HTML 页面的方法, 被用于在Web浏览器和网站服务器之间传递信息. HTTP 默认工作在 TCP 协议 80 端口, 但它<span style="color:blue">以明文方式发送内容, 不提供任何方式的数据加密</span>, 因此不适合传输敏感信息.</p>

<p>为了解决 HTTP 不安全的问题, <a href="https://en.wikipedia.org/wiki/HTTPS">HTTPS</a> 应运而生. HTTPS 是一种透过计算机网络进行安全通信的传输协议, 它经由 HTTP进行通信, 但<span style="color:blue">利用 SSL/TLS 来加密数据包保证数据的机密性和完整性</span>. HTTPS 默认工作在 TCP 协议 443 端口. HTTPS 比 HTTP 更加安全, 适合传输敏感信息.</p>

<h2 id="http-和-https">HTTP 和 HTTPS</h2>

<p>来源: <a href="https://www.runoob.com/w3cnote/http-vs-https.html">HTTP 与 HTTPS 的区别</a></p>

<blockquote>
  <p><strong>HTTP (HyperText Transfer Protocol: 超文本传输协议)</strong> 是一种用于分布式、协作式和超媒体信息系统的应用层协议.  简单来说就是一种发布和接收 HTML 页面的方法, 被用于在 Web 浏览器和网站服务器之间传递信息.</p>

  <p>HTTP 默认工作在 TCP 协议 80 端口, 用户访问网站 http:// 打头的都是标准 HTTP 服务.</p>

  <p><span style="color:blue">HTTP 协议以明文方式发送内容, 不提供任何方式的数据加密, 如果攻击者截取了 Web 浏览器和网站服务器之间的传输报文, 就可以直接读懂其中的信息.</span> 因此, HTTP 协议不适合传输一些敏感信息, 比如：信用卡号、密码等支付信息.</p>

  <p><strong>HTTPS (Hypertext Transfer Protocol Secure: 超文本传输安全协议)</strong> 是一种透过计算机网络进行安全通信的传输协议. <span style="color:blue">HTTPS 经由 HTTP 进行通信, 但利用 SSL/TLS 来加密数据包. HTTPS 开发的主要目的, 是提供对网站服务器的身份认证, 保护交换数据的隐私与完整性. </span></p>

  <p>HTTPS 默认工作在 TCP 协议 443 端口, 它的工作流程一般如以下方式：</p>

  <p>1、TCP 三次同步握手
2、客户端验证服务器数字证书
3、DH 算法协商对称加密算法的密钥、hash 算法的密钥
4、SSL 安全加密隧道协商完成
5、网页以加密的方式传输, 用协商的对称加密算法和密钥加密, 保证数据机密性；用协商的 hash 算法进行数据完整性保护, 保证数据不被篡改.</p>
</blockquote>

<h2 id="配置-nginx">配置 Nginx</h2>

<p>HTTPS 本身可以在提供 Web 服务的框架里配置, 但由于可提供服务的框架众多, 配置方式各不相同, 因此这里主要提供一种通用的方法, 即利用 Nginx 服务器<span style="color:blue">反向代理</span> Web 服务, 然后 HTTPS 统一配置在 Nginx 里.</p>

<div class="alert alert-info with-icon card">

<i class="icon-info-sign"></i>
<div class="zui-card-content">

<div class="title"><strong>提示</strong></div><hr />

<div class="content">
      <p>需要特别注意的是, 这种配置方法<strong>只有 Nginx 和 WWW 的通信是 HTTPS 加密的, 而 Nginx 和提供 Web 服务的程序仍然使用 HTTP</strong>. 因此这种方法适合于个人网站或小范围使用的场景下, 即 Nginx 服务和 Web 服务直接放在同一个服务器上, 或着放在安全性较高的局域网内部.</p>
    </div>

</div>
</div>

<div class="alert alert-primary with-icon card">

<i class="icon-star"></i>
<div class="zui-card-content notitle">

<div class="title"><strong>反向代理</strong></div><hr />

<div class="content">
      <p>我们通常所说的<strong>代理 (proxy)</strong> 指的是代理客户端, 从而可以通过代理服务器访问到无法直接访问的网站, 同时也可以达到隐藏客户端的目的, 例如 Shadowsocks, Clash 等代理软件. 而<strong>反向代理 (reverse proxy)</strong> 指的是代理服务端, 从而所有连接到服务端的请求都通过反向代理服务器转发到服务端, 同时也可以达到隐藏服务端的目的, 例如 Nginx 等可实现反向代理.</p>
    </div>

</div>
</div>

<p>首先需要安装 Nginx 工具 (本文默认都在 Ubuntu 服务器上操作). 先检查一下系统中是否已经安装 Nginx, 只需要查看是否存在存放 Nginx 配置的文件夹 <code class="language-plaintext highlighter-rouge">/etc/nginx</code> 是否存在, 如果不存在则安装一下:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt <span class="nb">install </span>nginx
</pre></td></tr></tbody></table></code></pre></div></div>

<p>安装后我们即可启动 Nginx 服务器. 这里使用 <code class="language-plaintext highlighter-rouge">systemctl</code> 工具来操作 Ubuntu 上的系统服务:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="c"># 启动 Nginx 服务器</span>
<span class="nb">sudo </span>systemctl start nginx

<span class="c"># 查看 Nginx 服务器的状态</span>
<span class="nb">sudo </span>systemctl status nginx

<span class="c"># 重载 Nginx 的配置文件 (后面会用到)</span>
<span class="nb">sudo </span>systemctl reload nginx
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="域名解析">域名解析</h2>

<p>HTTPS 通常需要和域名绑定, 因此我们需要一个域名绑定到服务器的外网 IP 地址上. 域名可以从域名服务商处购买, 比如阿里云, 华为云, 腾讯云等. 购买域名后, 域名服务商通常同时会提供域名解析服务, 把域名和 IP 地址绑定.</p>

<p>这里用的华为云的域名解析服务为例:</p>

<p>华为云登录后, 右上角点击<strong>控制台</strong></p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-1.png" data-caption="控制台" />
    
        
        <div class="container">
            <p>图 1. 控制台</p>
        </div>
    
</div>

<p>在快捷导航里点击<strong>域名注册 Domains</strong>. 如果没有该按钮, 也可以在搜索框里搜索该服务.</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-2.png" data-caption="域名注册按钮" />
    
        
        <div class="container">
            <p>图 2. 域名注册按钮</p>
        </div>
    
</div>

<p>如果还未注册域名, 则点击右上角的<strong>注册域名</strong>按钮, 搜索自己喜欢的域名进行注册并付费. 假设已经注册好了域名, 则点击<strong>解析</strong>按钮.</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-3.png" data-caption="解析按钮" />
    
        
        <div class="container">
            <p>图 3. 解析按钮</p>
        </div>
    
</div>

<p>点击右上角<strong>添加记录集</strong>以添加一条新的解析内容. 主要关注三个部分:</p>
<ul>
  <li>主机记录: 通常申请下来的是二级域名 (比如 <code class="language-plaintext highlighter-rouge">jarvis73.com</code>), 解析时通常填入一个自定义的三级域名</li>
  <li>类型: A 类型, 把域名指向 IPv4 地址</li>
  <li>值: 域名指向的 IPv4 地址</li>
</ul>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-4.png" data-caption="添加解析记录" />
    
        
        <div class="container">
            <p>图 4. 添加解析记录</p>
        </div>
    
</div>

<p>完成后点击确定, 就能在列表中看到新增的解析记录了. 通常 5 分钟或更快就能完成域名解析到 IP 地址的绑定. 可以通过 <code class="language-plaintext highlighter-rouge">ping hahaha.jarvis73.com</code> 来检查是否解析正确.</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-5.png" data-caption="解析记录列表" />
    
        
        <div class="container">
            <p>图 5. 解析记录列表</p>
        </div>
    
</div>

<h2 id="申请免费-ssl-证书">申请免费 SSL 证书</h2>

<blockquote>
  <p><strong>SSL 是指安全套接字层 (Secure Sockets Layer)</strong>, 简而言之, 它是一项标准技术, 可确保互联网连接安全, 保护两个系统之间发送的任何敏感数据, 防止网络犯罪分子读取和修改任何传输信息, 包括个人资料. 两个系统可能是指服务器和客户端（例如, 浏览器和购物网站）, 或两个服务器之间（例如, 含个人身份信息或工资单信息的应用程序）.</p>

  <p>此举可确保在用户和站点之间, 或两个系统之间传输的数据无法被读取. 它使用加密算法打乱传输中的数据, 防止数据通过连接传输时被黑客读取. 这里所说的数据是指任何敏感或个人信息, 例如信用卡号和其他财务信息、个人姓名和住址等.</p>

  <p><strong>TLS 是指传输层安全 (Transport Layer Security)</strong>, 是更为安全的升级版 SSL. 由于 SSL 这一术语更为常用, 因此我们仍然将我们的安全证书称作 SSL. 但当您从DigiCert购买 SSL 时, 您真正购买的是最新的 TLS 证书, 有 ECC、RSA 或 DSA 三种加密方式可以选择.</p>

  <p>如果某个网站受 SSL 证书保护, 其相应的 URL 中会显示 HTTPS. 单击浏览器地址栏的挂锁图标, 即可查看证书详细信息, 包括颁发机构和网站所有者的公司名称.</p>

  <p>来源: <a href="https://www.websecurity.digicert.com/zh/cn/security-topics/what-is-ssl-tls-https">什么是 SSL 证书？</a>. 略作改动.</p>
</blockquote>

<p>阿里云为每个用户赠送 20 个免费 SSL 证书, 其他家云服务商也会送免费证书, 大同小异, 这里仅用阿里云为例.</p>

<p>首先登录阿里云, 进入控制台. 点击左上角的三横线按钮展开阿里云的服务列表, 选择<strong>SSL 证书 (应用安全)</strong>. 找不到就在顶部的搜索栏里搜索一下.</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-6.png" data-caption="SSL 证书 (应用安全)" />
    
        
        <div class="container">
            <p>图 6. SSL 证书 (应用安全)</p>
        </div>
    
</div>

<p>点击左侧列表中的<strong>SSL 证书</strong>, 然后点击<strong>免费证书</strong>, 再点击<strong>创建证书</strong>. 如果没有领过, 那么此时会提示领取免费证书 (0 元购买). 领导后<strong>创建证书</strong>按钮就会显示<strong>20/20</strong>, 第一个数字表示剩余免费证书的数量, 第二个数字表示总共拥有过的免费证书数量.</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-7.png" data-caption="创建免费证书" />
    
        
        <div class="container">
            <p>图 7. 创建免费证书</p>
        </div>
    
</div>

<p>点击创建证书后下面列表中就会出现一个证书记录, 点击<strong>证书申请</strong>, 进入申请流程.</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-8.png" data-caption="证书" />
    
        
        <div class="container">
            <p>图 8. 证书</p>
        </div>
    
</div>

<p>SSL 证书为了安全性是和域名绑定的, 因此需要填入绑定的域名 <code class="language-plaintext highlighter-rouge">hahaha.jarvis73.com</code> (仅作示例, 填入你自己的), 选择<strong>手工 DNS 验证</strong> (这里是因为我的域名不在阿里云, 所以需要额外验证. 如果域名也是阿里云买的, 那可能就不需要 DNS 验证了) —&gt; 提交审核</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-9.png" data-caption="填写证明绑定的域名" />
    
        
        <div class="container">
            <p>图 9. 填写证明绑定的域名</p>
        </div>
    
</div>

<p>提交审核后, 如果域名不是阿里云的, 则需要进行 DNS 验证</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-10.png" data-caption="DNS 验证方法" />
    
        
        <div class="container">
            <p>图 10. DNS 验证方法</p>
        </div>
    
</div>

<p>验证的方法就是在域名解析服务商那里加入一条 TXT 类型的解析记录. 按本文的教程就是在华为云域名解析的地方新增一个记录集. 依次填入<strong>主机记录</strong> <code class="language-plaintext highlighter-rouge">_dnsauth.hahaha</code> (填入你自己的), 选择 TXT <strong>记录类型</strong>, 填入一长串<strong>记录值</strong>. 注意记录值在 TXT 类型下必须加双引号.</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-11.png" data-caption="新增 DNS 验证记录" />
    
        
        <div class="container">
            <p>图 11. 新增 DNS 验证记录</p>
        </div>
    
</div>

<p>然后返回阿里云点击<strong>验证</strong>按钮即可验证该域名的所有权是本人. 如果验证失败可能稍等一下, 可能解析记录还未更新. 或者检查一下填写的域名解析信息是否正确.</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-12.png" data-caption="验证成功" />
    
        
        <div class="container">
            <p>图 12. 验证成功</p>
        </div>
    
</div>

<p>关闭侧边弹窗, 返回证书列表, 等一会儿刷新一下就能看到证书申请下来了 (1 年的), 点击下载, 下载 nginx 的.</p>

<div class="polaroid">
    
    
    
    <img data-toggle="lightbox" src="/images/2023/04/https-13.png" data-caption="申请的证书" />
    
        
        <div class="container">
            <p>图 13. 申请的证书</p>
        </div>
    
</div>

<p>把证书拷贝到服务器上, 解压 zip 压缩包, 得到两个文件 (key 和 pem, 注意开头的数字是随机数, 可以不用管):</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>123456_hahaha.jarvis73.com.key
123456_hahaha.jarvis73.com.pem
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="在-nginx-中配置反向代理以及证书">在 Nginx 中配置反向代理以及证书</h2>

<p>创建 <code class="language-plaintext highlighter-rouge">/etc/nginx/cert</code> 文件夹, 把上面申请的 key 和 pem 两个文件放入其中.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nb">sudo mkdir</span> /etc/nginx/cert
<span class="nb">sudo mv </span>123456_hahaha.jarvis73.com.key /etc/nginx/cert
<span class="nb">sudo mv </span>123456_hahaha.jarvis73.com.pem /etc/nginx/cert
</pre></td></tr></tbody></table></code></pre></div></div>

<p>现在创建一个反向代理服务的配置. 在 <code class="language-plaintext highlighter-rouge">/etc/nginx/sites-available</code> 文件夹下新建一个空白文件 <code class="language-plaintext highlighter-rouge">chatgpt</code> (没有后缀要求), 写入以下配置 (<strong>注意修改带 TODO 的部分为你自己的配置</strong>):</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
</pre></td><td class="rouge-code"><pre>server {
    # 这段配置监听 80 端口 (http)
    listen 80;

    # TODO: 改为你自己的域名
    server_name hahaha.jarvis73.com;

    # 关闭服务器响应头中的“Server”信息。默认情况下，nginx 会在响应头中
    # 添加“Server”信息，包含服务器软件的名称和版本号。关闭这个选项可以
    # 增加服务器的安全性，因为攻击者可能会利用这些信息来针对特定版本的
    # 服务器软件进行攻击。
    server_tokens off;

    # 80 端口强制重定向到 https
    return 301 https://$server_name$request_uri;
}

# https 端口 443
server {
    listen 443 ssl http2;
    # TODO: 改为你自己的域名
    server_name hahaha.jarvis73.com;

    # ============================================================
    # 下面一段用于配置 SSL 证书
    # ============================================================

    # TODO: *.pem 和 *.key 修改为前面申请证书的实际文件名
    ssl_certificate /etc/nginx/cert/hahaha.jarvis73.com.pem;
    ssl_certificate_key /etc/nginx/cert/hahaha.jarvis73.com.key;

    # TODO: 自定义当前 nginx 服务日志的文件名
    access_log /var/log/nginx/chatgpt-access.log;
    error_log /var/log/nginx/chatgpt-error.log;

    server_tokens off;

    # ============================================================
    # 以下部分是反向代理的设置, 具体配置方式取决于所使用的服务.
    # 特别需要注意 location 和 proxy_pass 匹配的写法, 这里不再
    # 展开, 请自行上网搜索.
    # ============================================================

    # 关闭代理的缓存. 可以保留前端的打字机效果 (ChatGPT 前端用的. 其他服务一般不需要使用该配置, 可以注释掉.)
    proxy_buffering off;

    # 反向代理 web-server 的 /admin 和 /static 请求到 3389 端口
    location /admin {
        # TODO: 设置为本地开起来的后端服务地址
        proxy_pass http://127.0.0.1:3389;

        proxy_set_header Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
    location /static {
        # TODO: 设置为本地开起来的后端服务地址
        proxy_pass http://127.0.0.1:3389;

        proxy_set_header Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    # 反向代理 client 的请求到 8080 端口
    location / {
        # TODO: 设置为本地开起来的前端服务地址
        proxy_pass http://127.0.0.1:8080;

        proxy_set_header Host $http_host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
</pre></td></tr></tbody></table></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">sites-available</code> 中的配置文件用于归档, 如果需要让 Nginx 启用这些配置, 还需要把该配置放入 <code class="language-plaintext highlighter-rouge">/etc/nginx/sites-enabled</code>文件夹中. 这通常使用软链接来实现:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nb">cd</span> /etc/nginx/sites-enabled
<span class="nb">sudo ln</span> <span class="nt">-s</span> /etc/nginx/sites-available/chatgpt <span class="nb">.</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>然后重载 Nginx 配置</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl reload nginx
</pre></td></tr></tbody></table></code></pre></div></div>

<p>此时访问 <code class="language-plaintext highlighter-rouge">http://hahaha.jarvis73.com</code> 就会自动重定向到 <code class="language-plaintext highlighter-rouge">https://hahaha.jarvis73.com</code>, 同时浏览器在打开该链接时地址栏左侧会显示加锁, 点击锁的图标会显示<strong>连接安全</strong>(此网站具有由受信任的机构颁发的有效证书), 表示所配置的 SSL 证书核验通过.</p>

<p>免费证书通常是 1 年有效期, 到期需要重新申请证书并更新到 Nginx 服务中, 到期未更新则访问网站时锁的图标会加一个斜线表示不安全.</p>

        </article>
        <hr>

        <!-- 
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
            
            
        
         -->

        <div class="post-recent">
    <div class="pre">
        
        <p><strong>上一篇</strong> <a href="/2022/12/24/Diffusion-Model-5/">生成扩散模型(五): 采样加速 (Generative Diffusion Model: Sampling Acceleration)</a></p>
        
    </div>
    <div class="nex">

        
        <p><strong>下一篇</strong> <a href="/2023/05/15/ChatGPT-Plugins/">ChatGPT 70 款插件测评 惊艳的开发过程与宏大的商业化愿景</a></p>
        
    </div>
</div>


        <!-- <h2 id="comments">Comments</h2>
        



 -->


    </div>
    <button class="anchor"><i class="fa fa-anchor"></i></button>
    <div class="right-jekyll">
        <div class="wrap">

            <!-- Content -->
            <div class="side content">
                <div>
                    Content
                </div>
                <ul id="content-side" class="content-ul">
                    
                    <li><a href="#comments">Comments</a></li>
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <!-- <div class="side">bbbb</div> -->
        </div>
    </div>
</div>
<script>
/**
 * target _blank
 */
(function() {
    var aTags = document.querySelectorAll('article a:not([id]):not([class])')
    for (var i = 0; i < aTags.length; i++) {
        if (aTags[i].getAttribute('href').startsWith('#'))
        {
            continue
        }
        aTags[i].setAttribute('target', '_blank')
    }
}());
</script>
<script src="/js/pageContent.js " charset="utf-8"></script>

    <footer class="site-footer">


    <div class="wrapper">

        <p class="contact">
            联系我: 
            <a href="https://github.com/jarvis73" title="GitHub"><i class="fa fa-github" aria-hidden="true"></i></a>  
            <a href="mailto:zjw.math@qq.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>   
            <a href="https://www.zhihu.com/people/lin-xi-1-1" title="Zhihu"><i class="iconfont icon-daoruzhihu"></i></a>      
        </p>
        <p>
            <i class="fa fa-eye" style="padding-right: 2px;"></i> 访问量: <span id="busuanzi_value_site_pv"></span>次 | <i class="fa fa-user" style="padding-right: 2px;"></i> 访客数<span id="busuanzi_value_site_uv"></span>人次
        </p>
        <p class="power">
            网站支持 <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a> | 主题支持 <a href="https://github.com/Gaohaoyang/gaohaoyang.github.io">HyG</a> & <a href="https://github.com/Jarvis73/jarvis73.github.io">Jarvis73</a>
        </p>
        <p>
            <img src="/images/misc/beian.png" style="padding-right: 2px; padding-bottom: 4px; vertical-align: middle;" /> <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo" class="beian" >浙公网安备 33010602011353号 | </a>
            <a target="_blank" href="https://beian.miit.gov.cn/" class="beian">浙ICP备2020038513号-1</a>
        </p>
    </div>
</footer>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" data-scroll>
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script type='text/javascript' src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>
    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/smooth-scroll.min.js " charset="utf-8"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/zui/1.9.2/lib/jquery/jquery.js" charset="utf-8"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/zui/1.9.2/js/zui.min.js" charset="utf-8"></script>
    <script src="/js/index_page.js" charset="utf-8"></script>
    <script src="/js/functions.js" charset="utf-8"></script>
    <script type="text/javascript">
      smoothScroll.init({
        speed: 500, // Integer. How fast to complete the scroll in milliseconds
        easing: 'easeInOutCubic', // Easing pattern to use
        offset: 20, // Integer. How far to offset the scrolling anchor location in pixels
      });
    </script>
  </body>

</html>
